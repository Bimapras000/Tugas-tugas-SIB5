3. DELIMITER $$
    CREATE FUNCTION kategori_harga(harga DOUBLE) RETURNS VARCHAR(255)
    -> BEGIN
    ->     DECLARE kategori VARCHAR(255);
    ->
    ->     IF harga <= 500000 THEN
    ->         SET kategori = 'murah';
    ->     ELSEIF harga <= 3000000 THEN
    ->         SET kategori = 'sedang';
    ->     ELSEIF harga <= 10000000 THEN
    ->         SET kategori = 'mahal';
    ->     ELSE
    ->         SET kategori = 'sangat mahal';
    ->     END IF;
    ->
    ->     RETURN kategori;
    -> END $$
    DELIMITER ;
    SELECT nama, harga_jual, kategori_harga(harga_jual) AS kategori FROM produk;


2. DELIMITER $$
     CREATE PROCEDURE kurangi_stok(IN produk_id INT, IN jumlah_pesanan INT)
    -> BEGIN
    ->     DECLARE stok_produk INT;
    -> SELECT stok INTO stok_produk FROM produk WHERE id = produk_id;
    -> SET stok_produk = stok_produk - jumlah_pesanan;
    -> UPDATE produk SET stok = stok_produk WHERE id = produk_id;
    -> END $$
    DELIMITER ;
    CALL kurangi_stok(1, 5);

3. DELIMITER $$
     CREATE TRIGGER trig_kurangi_stok AFTER INSERT ON pesanan_items
    -> FOR EACH ROW
    -> BEGIN
    ->     DECLARE produk_id INT;
    ->     DECLARE jumlah_pesanan INT;
    -> SELECT NEW.produk_id, NEW.Qty INTO produk_id, jumlah_pesanan;
    -> CALL kurangi_stok(produk_id, jumlah_pesanan);
    -> END $$
    DELIMITER ;
    call kurangi_stok(3, 5);